{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "type": "object",
  "required": ["io", "columns", "uniprot", "network", "batch", "logging"],
  "properties": {
    "io": {
      "type": "object",
      "required": ["input", "output", "csv"],
      "properties": {
        "input": {
          "type": "object",
          "required": ["encoding"],
          "properties": {
            "encoding": {
              "type": "string",
              "description": "File encoding for input CSV",
              "examples": ["utf-8"]
            }
          }
        },
        "output": {
          "type": "object",
          "required": ["encoding"],
          "properties": {
            "encoding": {
              "type": "string",
              "description": "File encoding for output CSV",
              "examples": ["utf-8"]
            }
          }
        },
        "csv": {
          "type": "object",
          "required": ["separator", "multivalue_delimiter"],
          "properties": {
            "separator": { "type": "string", "minLength": 1 },
            "multivalue_delimiter": { "type": "string", "minLength": 1 }
          }
        }
      }
    },
    "columns": {
      "type": "object",
      "properties": {
        "chembl_id": { "type": "string", "minLength": 1 },
        "target_chembl_id": { "type": "string", "minLength": 1 },
        "uniprot_out": { "type": "string", "minLength": 1 }
      },
      "required": ["uniprot_out"],
      "anyOf": [
        {"required": ["chembl_id"]},
        {"required": ["target_chembl_id"]}
      ]
    },
    "uniprot": {
      "type": "object",
      "required": ["base_url", "id_mapping", "polling", "rate_limit", "retry"],
      "properties": {
        "base_url": { "type": "string", "minLength": 1 },
        "id_mapping": {
          "type": "object",
          "required": ["endpoint"],
          "properties": {
            "endpoint": { "type": "string", "minLength": 1 },
            "status_endpoint": { "type": "string" },
            "results_endpoint": { "type": "string" },
            "from_db": { "type": "string" },
            "to_db": { "type": "string" }
          }
        },
        "polling": {
          "type": "object",
          "required": ["interval_sec"],
          "properties": { "interval_sec": { "type": "number", "minimum": 0 } }
        },
        "rate_limit": {
          "type": "object",
          "required": ["rps"],
          "properties": { "rps": { "type": "number", "exclusiveMinimum": 0 } }
        },
        "retry": {
          "type": "object",
          "required": ["max_attempts", "backoff_sec"],
          "properties": {
            "max_attempts": { "type": "integer", "minimum": 0 },
            "backoff_sec": { "type": "number", "minimum": 0 }
          }
        }
      }
    },
    "network": {
      "type": "object",
      "required": ["timeout_sec"],
      "properties": { "timeout_sec": { "type": "number", "exclusiveMinimum": 0 } }
    },
    "batch": {
      "type": "object",
      "required": ["size"],
      "properties": { "size": { "type": "integer", "minimum": 1 } }
    },
    "logging": {
      "type": "object",
      "required": ["level"],
      "properties": {
        "level": {
          "type": "string",
          "enum": ["CRITICAL", "ERROR", "WARNING", "INFO", "DEBUG"]
        }
      }
    },
    "pipeline": {
      "type": "object",
      "properties": {
        "rate_limit_rps": { "type": "number", "exclusiveMinimum": 0 },
        "retries": { "type": "integer", "minimum": 0 },
        "timeout_sec": { "type": "number", "exclusiveMinimum": 0 },
        "species_priority": {
          "type": "array",
          "items": { "type": "string" }
        },
        "list_format": { "type": "string", "enum": ["json", "pipe"] },
        "include_sequence": { "type": "boolean" },
        "include_isoforms": { "type": "boolean" },
        "columns": {
          "type": "array",
          "items": { "type": "string" }
        },
        "iuphar": {
          "type": "object",
          "properties": {
            "affinity_parameter": { "type": "string" },
            "approved_only": { "type": ["boolean", "null"] },
            "primary_target_only": { "type": "boolean" }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "hgnc": {
      "type": "object",
      "required": ["hgnc", "network", "rate_limit", "output"],
      "properties": {
        "columns": {
          "type": "array",
          "items": { "type": "string" }
        },
        "hgnc": {
          "type": "object",
          "required": ["base_url"],
          "properties": { "base_url": { "type": "string", "minLength": 1 } },
          "additionalProperties": false
        },
        "network": {
          "type": "object",
          "required": ["timeout_sec", "max_retries"],
          "properties": {
            "timeout_sec": { "type": "number", "exclusiveMinimum": 0 },
            "max_retries": { "type": "integer", "minimum": 0 }
          },
          "additionalProperties": false
        },
        "rate_limit": {
          "type": "object",
          "required": ["rps"],
          "properties": { "rps": { "type": "number", "exclusiveMinimum": 0 } },
          "additionalProperties": false
        },
        "output": {
          "type": "object",
          "required": ["sep", "encoding"],
          "properties": {
            "sep": { "type": "string", "minLength": 1 },
            "encoding": { "type": "string", "minLength": 1 }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "orthologs": {
      "type": "object",
      "properties": {
        "enabled": { "type": "boolean" },
        "primary_source": { "type": "string" },
        "target_species": {
          "type": "array",
          "items": { "type": "string" }
        },
        "species_priority": {
          "type": "array",
          "items": { "type": "string" }
        },
        "rate_limit_rps": { "type": "number", "exclusiveMinimum": 0 },
        "timeout_sec": { "type": "number", "exclusiveMinimum": 0 },
        "retries": { "type": "integer", "minimum": 0 },
        "backoff_base_sec": { "type": "number", "minimum": 0 }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
